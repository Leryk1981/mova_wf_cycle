{"ts":"2025-12-16T21:44:23.297Z","method":"GET","path":"/experimental/tool/ids","status":500,"duration_ms":14,"request_body":null,"response_text":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n  </head>\n  <body>\n    <script id=\"__bunfallback\" type=\"binary/peechy\">\n      ASMAAABHRVQgLSAvZXhwZXJpbWVudGFsL3Rvb2wvaWRzIGZhaWxlZAMIBCoDEAAAAEV4Y2VwdGlvbk9jdXJyZWQAAAAAAAAAAAEAAAABAAAAAQAAAAFPAAAAQ2Fubm90IGZpbmQgbW9kdWxlICdAb2N0b2tpdC9yZXN0JyBmcm9tICcvd29yay8ub3BlbmNvZGUvdG9vbC9naXRodWItdHJpYWdlLnRzJwAAAAAAAQ0AAABAb2N0b2tpdC9yZXN0AgAABQUAAAAvd29yawA\n    </sc"}
{"ts":"2025-12-16T21:44:23.341Z","method":"POST","path":"/session","status":200,"duration_ms":36,"request_body":{"agent":"general"},"response_body":{"id":"ses_4d6e0e3e1ffe4XFCTZc3zWcCJN","version":"local","projectID":"global","directory":"/work","title":"New session - 2025-12-16T21:44:23.326Z","time":{"created":1765921463326,"updated":1765921463326}}}
{"ts":"2025-12-16T21:44:23.582Z","method":"POST","path":"/session/ses_4d6e0e3e1ffe4XFCTZc3zWcCJN/shell","status":200,"duration_ms":239,"request_body":{"command":"head -c 4096 -- '/work/packages/opencode/src/server/server.ts'","agent":"general"},"response_body":{"info":{"id":"msg_b291f1c84001baOVFJH9RJjLGA","sessionID":"ses_4d6e0e3e1ffe4XFCTZc3zWcCJN","parentID":"msg_b291f1c4c001OJBEcWW3JRjs2v","mode":"general","agent":"general","cost":0,"path":{"cwd":"/work","root":"/work"},"time":{"created":1765921463428,"completed":1765921463529},"role":"assistant","tokens":{"input":0,"output":0,"reasoning":0,"cache":{"read":0,"write":0}},"modelID":"big-pickle","providerID":"opencode"},"parts":[{"type":"tool","id":"prt_b291f1c8e001pwRber54BPq7Vu","messageID":"msg_b291f1c84001baOVFJH9RJjLGA","sessionID":"ses_4d6e0e3e1ffe4XFCTZc3zWcCJN","tool":"bash","callID":"01KCMHY74E4TN2759YAWQY8N7H","state":{"status":"completed","time":{"start":1765921463438,"end":1765921463532},"input":{"command":"head -c 4096 -- '/work/packages/opencode/src/server/server.ts'"},"title":"","metadata":{"output":"import { BusEvent } from \"@/bus/bus-event\"\r\nimport { Bus } from \"@/bus\"\r\nimport { GlobalBus } from \"@/bus/global\"\r\nimport { Log } from \"../util/log\"\r\nimport { describeRoute, generateSpecs, validator, resolver, openAPIRouteHandler } from \"hono-openapi\"\r\nimport { Hono } from \"hono\"\r\nimport { cors } from \"hono/cors\"\r\nimport { stream, streamSSE } from \"hono/streaming\"\r\nimport { proxy } from \"hono/proxy\"\r\nimport { Session } from \"../session\"\r\nimport z from \"zod\"\r\nimport { Provider } from \"../provider/provider\"\r\nimport { filter, mapValues, sortBy, pipe } from \"remeda\"\r\nimport { NamedError } from \"@opencode-ai/util/error\"\r\nimport { ModelsDev } from \"../provider/models\"\r\nimport { Ripgrep } from \"../file/ripgrep\"\r\nimport { Config } from \"../config/config\"\r\nimport { File } from \"../file\"\r\nimport { LSP } from \"../lsp\"\r\nimport { Format } from \"../format\"\r\nimport { MessageV2 } from \"../session/message-v2\"\r\nimport { TuiRoute } from \"./tui\"\r\nimport { Permission } from \"../permission\"\r\nimport { Instance } from \"../project/instance\"\r\nimport { Vcs } from \"../project/vcs\"\r\nimport { Agent } from \"../agent/agent\"\r\nimport { Auth } from \"../auth\"\r\nimport { Command } from \"../command\"\r\nimport { ProviderAuth } from \"../provider/auth\"\r\nimport { Global } from \"../global\"\r\nimport { ProjectRoute } from \"./project\"\r\nimport { ToolRegistry } from \"../tool/registry\"\r\nimport { zodToJsonSchema } from \"zod-to-json-schema\"\r\nimport { SessionPrompt } from \"../session/prompt\"\r\nimport { SessionCompaction } from \"../session/compaction\"\r\nimport { SessionRevert } from \"../session/revert\"\r\nimport { lazy } from \"../util/lazy\"\r\nimport { Todo } from \"../session/todo\"\r\nimport { InstanceBootstrap } from \"../project/bootstrap\"\r\nimport { MCP } from \"../mcp\"\r\nimport { Storage } from \"../storage/storage\"\r\nimport type { ContentfulStatusCode } from \"hono/utils/http-status\"\r\nimport { TuiEvent } from \"@/cli/cmd/tui/event\"\r\nimport { Snapshot } from \"@/snapshot\"\r\nimport { SessionSummary } from \"@/session/summary\"\r\nimport { SessionStatus } from \"@/session/status\"\r\nimport { upgradeWebSocket, websocket } from \"hono/bun\"\r\nimport { errors } from \"./error\"\r\nimport { Pty } from \"@/pty\"\r\n\r\n// @ts-ignore This global is needed to prevent ai-sdk from logging warnings to stdout https://github.com/vercel/ai/blob/2dc67e0ef538307f21368db32d5a12345d98831b/packages/ai/src/logger/log-warnings.ts#L85\r\nglobalThis.AI_SDK_LOG_WARNINGS = false\r\n\r\nexport namespace Server {\r\n  const log = Log.create({ service: \"server\" })\r\n\r\n  export const Event = {\r\n    Connected: BusEvent.define(\"server.connected\", z.object({})),\r\n    Disposed: BusEvent.define(\"global.disposed\", z.object({})),\r\n  }\r\n\r\n  const app = new Hono()\r\n  export const App = lazy(() =>\r\n    app\r\n      .onError((err, c) => {\r\n        log.error(\"failed\", {\r\n          error: err,\r\n        })\r\n        if (err instanceof NamedError) {\r\n          let status: ContentfulStatusCode\r\n          if (err instanceof Storage.NotFoundError) status = 404\r\n          else if (err instanceof Provider.ModelNotFoundError) status = 400\r\n          else status = 500\r\n          return c.json(err.toObject(), { status })\r\n        }\r\n        const message = err instanceof Error && err.stack ? err.stack : err.toString()\r\n        return c.json(new NamedError.Unknown({ message }).toObject(), {\r\n          status: 500,\r\n        })\r\n      })\r\n      .use(async (c, next) => {\r\n        const skipLogging = c.req.path === \"/log\"\r\n        if (!skipLogging) {\r\n          log.info(\"request\", {\r\n            method: c.req.method,\r\n            path: c.req.path,\r\n          })\r\n        }\r\n        const timer = log.time(\"request\", {\r\n          method: c.req.method,\r\n          path: c.req.path,\r\n        })\r\n        await next()\r\n        if (!skipLogging) {\r\n          timer.stop()\r\n        }\r\n      })\r\n      .use(cors())\r\n      .get(\r\n        \"/global/event\",\r\n        describeRoute({\r\n          summary: \"Get global events\",\r\n          description: \"Subscribe to global events from the OpenCode system using server-sent events.\",\r\n          operationId: \"global.event\",\r\n          responses: {\r\n      ","description":""},"output":"import { BusEvent } from \"@/bus/bus-event\"\r\nimport { Bus } from \"@/bus\"\r\nimport { GlobalBus } from \"@/bus/global\"\r\nimport { Log } from \"../util/log\"\r\nimport { describeRoute, generateSpecs, validator, resolver, openAPIRouteHandler } from \"hono-openapi\"\r\nimport { Hono } from \"hono\"\r\nimport { cors } from \"hono/cors\"\r\nimport { stream, streamSSE } from \"hono/streaming\"\r\nimport { proxy } from \"hono/proxy\"\r\nimport { Session } from \"../session\"\r\nimport z from \"zod\"\r\nimport { Provider } from \"../provider/provider\"\r\nimport { filter, mapValues, sortBy, pipe } from \"remeda\"\r\nimport { NamedError } from \"@opencode-ai/util/error\"\r\nimport { ModelsDev } from \"../provider/models\"\r\nimport { Ripgrep } from \"../file/ripgrep\"\r\nimport { Config } from \"../config/config\"\r\nimport { File } from \"../file\"\r\nimport { LSP } from \"../lsp\"\r\nimport { Format } from \"../format\"\r\nimport { MessageV2 } from \"../session/message-v2\"\r\nimport { TuiRoute } from \"./tui\"\r\nimport { Permission } from \"../permission\"\r\nimport { Instance } from \"../project/instance\"\r\nimport { Vcs } from \"../project/vcs\"\r\nimport { Agent } from \"../agent/agent\"\r\nimport { Auth } from \"../auth\"\r\nimport { Command } from \"../command\"\r\nimport { ProviderAuth } from \"../provider/auth\"\r\nimport { Global } from \"../global\"\r\nimport { ProjectRoute } from \"./project\"\r\nimport { ToolRegistry } from \"../tool/registry\"\r\nimport { zodToJsonSchema } from \"zod-to-json-schema\"\r\nimport { SessionPrompt } from \"../session/prompt\"\r\nimport { SessionCompaction } from \"../session/compaction\"\r\nimport { SessionRevert } from \"../session/revert\"\r\nimport { lazy } from \"../util/lazy\"\r\nimport { Todo } from \"../session/todo\"\r\nimport { InstanceBootstrap } from \"../project/bootstrap\"\r\nimport { MCP } from \"../mcp\"\r\nimport { Storage } from \"../storage/storage\"\r\nimport type { ContentfulStatusCode } from \"hono/utils/http-status\"\r\nimport { TuiEvent } from \"@/cli/cmd/tui/event\"\r\nimport { Snapshot } from \"@/snapshot\"\r\nimport { SessionSummary } from \"@/session/summary\"\r\nimport { SessionStatus } from \"@/session/status\"\r\nimport { upgradeWebSocket, websocket } from \"hono/bun\"\r\nimport { errors } from \"./error\"\r\nimport { Pty } from \"@/pty\"\r\n\r\n// @ts-ignore This global is needed to prevent ai-sdk from logging warnings to stdout https://github.com/vercel/ai/blob/2dc67e0ef538307f21368db32d5a12345d98831b/packages/ai/src/logger/log-warnings.ts#L85\r\nglobalThis.AI_SDK_LOG_WARNINGS = false\r\n\r\nexport namespace Server {\r\n  const log = Log.create({ service: \"server\" })\r\n\r\n  export const Event = {\r\n    Connected: BusEvent.define(\"server.connected\", z.object({})),\r\n    Disposed: BusEvent.define(\"global.disposed\", z.object({})),\r\n  }\r\n\r\n  const app = new Hono()\r\n  export const App = lazy(() =>\r\n    app\r\n      .onError((err, c) => {\r\n        log.error(\"failed\", {\r\n          error: err,\r\n        })\r\n        if (err instanceof NamedError) {\r\n          let status: ContentfulStatusCode\r\n          if (err instanceof Storage.NotFoundError) status = 404\r\n          else if (err instanceof Provider.ModelNotFoundError) status = 400\r\n          else status = 500\r\n          return c.json(err.toObject(), { status })\r\n        }\r\n        const message = err instanceof Error && err.stack ? err.stack : err.toString()\r\n        return c.json(new NamedError.Unknown({ message }).toObject(), {\r\n          status: 500,\r\n        })\r\n      })\r\n      .use(async (c, next) => {\r\n        const skipLogging = c.req.path === \"/log\"\r\n        if (!skipLogging) {\r\n          log.info(\"request\", {\r\n            method: c.req.method,\r\n            path: c.req.path,\r\n          })\r\n        }\r\n        const timer = log.time(\"request\", {\r\n          method: c.req.method,\r\n          path: c.req.path,\r\n        })\r\n        await next()\r\n        if (!skipLogging) {\r\n          timer.stop()\r\n        }\r\n      })\r\n      .use(cors())\r\n      .get(\r\n        \"/global/event\",\r\n        describeRoute({\r\n          summary: \"Get global events\",\r\n          description: \"Subscribe to global events from the OpenCode system using server-sent events.\",\r\n          operationId: \"global.event\",\r\n          responses: {\r\n      "}}]}}