{
  "envelope_id": "env.mova_check_run_v1",
  "verb": "validate",
  "resource": "note",
  "input": {
    "context_kind": "schema",
    "file_path": "lab/env/env.dpp_export_v1.schema.json",
    "content_after": "{\n  \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n  \"$id\": \"https://mova.dev/lab/env/env.dpp_export_v1.schema.json\",\n  \"title\": \"env.dpp_export_v1\",\n  \"description\": \"Lab-level envelope to request export of a DPP battery passport to external formats (GS1 EPCIS, OPC UA, Catena-X, native JSON).\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"envelope_type\": {\n      \"type\": \"string\",\n      \"const\": \"env.dpp_export_v1\"\n    },\n    \"verb\": {\n      \"type\": \"string\",\n      \"const\": \"transform\"\n    },\n    \"id\": {\n      \"type\": \"string\",\n      \"description\": \"Envelope identifier (optional).\"\n    },\n    \"time\": {\n      \"type\": \"string\",\n      \"format\": \"date-time\",\n      \"description\": \"Envelope creation time.\"\n    },\n    \"actor\": {\n      \"type\": \"object\",\n      \"description\": \"Actor initiating the export request.\",\n      \"properties\": {\n        \"role\": {\n          \"type\": \"string\"\n        },\n        \"id\": {\n          \"type\": \"string\"\n        }\n      },\n      \"additionalProperties\": true\n    },\n    \"meta\": {\n      \"type\": \"object\",\n      \"description\": \"Additional metadata (domain, labels, correlation id, etc.).\",\n      \"additionalProperties\": true\n    },\n    \"roles\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"initiator\": {\n          \"type\": \"string\",\n          \"description\": \"Who initiates the export (e.g., manufacturer or operator).\"\n        },\n        \"transformer\": {\n          \"type\": \"string\",\n          \"description\": \"Service or component performing the export (optional).\"\n        }\n      },\n      \"required\": [\n        \"initiator\"\n      ],\n      \"additionalProperties\": false\n    },\n    \"data\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"passport_id\": {\n          \"type\": \"string\",\n          \"description\": \"Battery passport identifier to export.\"\n        },\n        \"target_format\": {\n          \"type\": \"string\",\n          \"enum\": [\n            \"gs1_epcis\",\n            \"opc_ua\",\n            \"catena_x\",\n            \"native_json\"\n          ],\n          \"description\": \"Target export format.\"\n        },\n        \"options\": {\n          \"type\": \"object\",\n          \"description\": \"Format-specific export options; domain-specific and not standardized in core.\",\n          \"additionalProperties\": true\n        },\n        \"roles\": {\n          \"type\": \"object\",\n          \"description\": \"Optional roles override scoped to data for format-specific handling.\",\n          \"properties\": {\n            \"initiator\": {\n              \"type\": \"string\"\n            },\n            \"transformer\": {\n              \"type\": \"string\"\n            }\n          },\n          \"required\": [\n            \"initiator\"\n          ],\n          \"additionalProperties\": false\n        }\n      },\n      \"required\": [\n        \"passport_id\",\n        \"target_format\"\n      ],\n      \"additionalProperties\": false\n    }\n  },\n  \"required\": [\n    \"envelope_type\",\n    \"verb\",\n    \"data\"\n  ],\n  \"additionalProperties\": false\n}",
    "change_summary": "Add env.dpp_export_v1 schema for DPP export to GS1 EPCIS/OPC UA/Catena-X/native JSON.",
    "check_level": "validate",
    "mova_core_version": "4.0.0",
    "target_core_version": "4.1.0-draft"
  },
  "meta": {
    "domain": "dpp_lab",
    "labels": [
      "dpp_lab",
      "L2_02",
      "dpp_export_envelope"
    ]
  }
}
