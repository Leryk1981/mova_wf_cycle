{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://mova.dev/packs/invoice_ap_v0/env.invoice_intake_run_v0.schema.json",
  "title": "Invoice Intake Run v0",
  "description": "End-to-end envelope for running the invoice intake runtime (request, result, and supporting metadata).",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "request",
    "result",
    "evidence_refs",
    "meta"
  ],
  "properties": {
    "request": {
      "$ref": "https://mova.dev/packs/invoice_ap_v0/ds.invoice_intake_request_v0.schema.json",
      "description": "Validated intake payload."
    },
    "result": {
      "$ref": "https://mova.dev/packs/invoice_ap_v0/ds.invoice_intake_result_v0.schema.json",
      "description": "Deterministic totals generated for the intake payload."
    },
    "evidence_refs": {
      "type": "array",
      "description": "List of filesystem or object-store references that capture supporting evidence.",
      "items": {
        "type": "string"
      }
    },
    "meta": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "run_id",
        "artifacts_dir",
        "runtime_version"
      ],
      "properties": {
        "run_id": {
          "type": "string",
          "description": "Unique identifier for the runtime execution."
        },
        "artifacts_dir": {
          "type": "string",
          "description": "Directory where request/result/evidence artifacts reside."
        },
        "runtime_version": {
          "type": "string",
          "description": "Version string embedded by the runtime (e.g. git commit)."
        },
        "git_commit": {
          "type": "string",
          "description": "Short git hash of the repo that produced this run."
        },
        "generated_at": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the run completed."
        },
        "ext": {
          "type": "object",
          "description": "Extension metadata (timezone, operator, etc.).",
          "additionalProperties": true
        }
      }
    }
  }
}
