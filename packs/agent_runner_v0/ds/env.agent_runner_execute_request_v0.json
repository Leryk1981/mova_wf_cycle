{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "env.agent_runner_execute_request_v0",
  "title": "Agent runner execute request v0",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "request_id": {
      "type": "string",
      "description": "Unique identifier for the request"
    },
    "mova_version": {
      "type": "string",
      "const": "4.1.1"
    },
    "agent_bundle_dir": {
      "type": "string",
      "description": "path to generated bundle root; must contain mova/"
    },
    "role_id": {
      "type": "string",
      "enum": ["planner", "executor", "qa", "notary"]
    },
    "pipeline_stage": {
      "type": "string",
      "enum": ["plan", "execute", "verify", "notarize"]
    },
    "task": {
      "type": "object",
      "description": "free-form JSON, required",
      "additionalProperties": true,
      "minProperties": 1
    },
    "control_mcp": {
      "type": "object",
      "properties": {
        "mode": {
          "type": "string",
          "enum": ["stdio"]
        },
        "command": {
          "type": "string",
          "description": "how to start MCP server process, e.g. node ... or npm run ..."
        },
        "cwd": {
          "type": "string",
          "description": "optional"
        },
        "env_allowlist": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "optional; only passes through these env vars"
        }
      },
      "required": ["mode", "command"],
      "additionalProperties": false
    },
    "limits": {
      "type": "object",
      "properties": {
        "timeout_ms": {
          "type": "integer",
          "description": "default"
        },
        "max_json_bytes": {
          "type": "integer",
          "description": "default"
        }
      },
      "additionalProperties": false
    }
  },
  "required": ["mova_version", "agent_bundle_dir", "role_id", "pipeline_stage", "task", "control_mcp", "limits"]
}